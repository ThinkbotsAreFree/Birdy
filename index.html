<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>BirdyVM</title>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <link href="css/normalize.css" rel="stylesheet">
    <link href="css/bigpicture.css" rel="stylesheet">
    <link href="css/toastify.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
</head>

<body>

    <div id="toolbar">
        <button onclick="sys.step(false, false, this)">Step Once</button>
        <button onclick="sys.step(true, false, this)">Step While</button>
        <button onclick="sys.step(true, true, this)">Run Loop</button>
        <button onclick="sys.stop()">Stop Loop</button>
        <button onclick="window.open('https://github.com/ThinkbotsAreFree/Birdy', '_blank')">Help Docs</button>
        <button onclick="bigpicture.zoomIn()">Zoom<br>In</button>
        <button onclick="bigpicture.zoomOut()">Zoom<br>Out</button>
        <input id="user-input" type="text" placeholder="command">
        <img src="images/birdy-transparent.png">
    </div>

    <span id="info">
        <span id="version">BirdyVM - Version 0.1.0. - </span>
        <span id="status">Paused</span>
    </span>

    <div id="bigpicture-container">
        <div id="bigpicture" data-zoom="1" data-x="721" data-y="480">
            <div class="text" data-size="20" data-x="1000" data-y="1000">[BirdyVM]</div>
        </div>
    </div>

    <script type="text/javascript" src="js/birdy.js"></script>
    <script type="text/javascript" src="js/comment-parser.js"></script>
    <script type="text/javascript" src="js/parser.js"></script>
    <script type="text/javascript" src="js/bigpicture.js"></script>
    <script type="text/javascript" src="js/toastify-js.js"></script>

    <script>

        sys.populate(`
            | user
        `);

        $("#user-input").keypress(function (e) {

            if (e.which === 13) {

                var parsed;
                try {
                    var com = $(this).val();
                    com = "| user " + com;
                    parsed = parser.parse(commentParser.parse(com));
                } catch (e) {
                    sys.output("system", "Parser failed: " + com);
                }
                if (parsed) {

                    sys.unit['1'].AST.commands = parsed.units[0].commands;

                    sys.jobQueue.push({
                        receiver: '1',
                        message: "user",
                        signature: "user",
                        capture: {},
                        senderId: '1'
                    });

                    if (sys.status === "Paused") sys.step(true, false, true);
                    $(this).val('');
                }
            }
        });


    </script>
</body>

</html>